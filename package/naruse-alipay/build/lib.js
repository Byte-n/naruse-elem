function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty$1(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _typeof$1(e){"@babel/helpers - typeof";return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$1(e)}function asyncGeneratorStep(e,t,r,n,s,i,a){try{var o=e[i](a);var u=o.value}catch(e){r(e);return}if(o.done){t(u)}else{Promise.resolve(u).then(n,s)}}function _asyncToGenerator(o){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=o.apply(e,a);function s(e){asyncGeneratorStep(n,t,r,s,i,"next",e)}function i(e){asyncGeneratorStep(n,t,r,s,i,"throw",e)}s(undefined)})}}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){if(t)_defineProperties(e.prototype,t);if(r)_defineProperties(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function _defineProperty$1(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});Object.defineProperty(e,"prototype",{writable:false});if(t)_setPrototypeOf(e,t)}function _getPrototypeOf(e){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return _getPrototypeOf(e)}function _setPrototypeOf(e,t){_setPrototypeOf=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return _setPrototypeOf(e,t)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _assertThisInitialized(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function _possibleConstructorReturn(e,t){if(t&&(typeof t==="object"||typeof t==="function")){return t}else if(t!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(e)}function _createSuper(s){var i=_isNativeReflectConstruct();return function e(){var t=_getPrototypeOf(s),r;if(i){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(t,arguments,n)}else{r=t.apply(this,arguments)}return _possibleConstructorReturn(this,r)}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var r=e==null?null:typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r==null)return;var n=[];var s=true;var i=false;var a,o;try{for(r=r.call(e);!(s=(a=r.next()).done);s=true){n.push(a.value);if(t&&n.length===t)break}}catch(e){i=true;o=e}finally{try{if(!s&&r["return"]!=null)r["return"]()}finally{if(i)throw o}}return n}function _unsupportedIterableToArray(e,t){if(!e)return;if(typeof e==="string")return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}function _arrayLikeToArray(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}const createLogger=e=>{const t={debug(){console.debug(`[${e}][debugger]`,...arguments)},warn(){console.warn(`[${e}][warn]`,...arguments)},info(){console.info(`[${e}][info]`,...arguments)},error(){console.error(`[${e}][error]`,...arguments)}};return t};const logger$1=createLogger("naurse-error");const temporarilyNotSupport=function e(t){return()=>{const e=`暂时不支持 API ${t}`;logger$1.error(e);return Promise.reject({errMsg:e})}};class EventBus{constructor(){this.listeners={}}on(e,t){if(this.listeners[e]===undefined){this.listeners[e]=[]}this.listeners[e].push(t)}off(e,t){if(this.listeners[e]===undefined){return}const r=this.listeners[e].indexOf(t);if(r!==-1){this.listeners[e].splice(r,1)}}emit(e,...t){if(this.listeners[e]===undefined){return}this.listeners[e].forEach(e=>{e(...t)})}clear(){this.listeners={}}}const globalEvent=new EventBus;const trimReg=/(^\s*)|(\s*$)/g;const isEmpty=e=>{if(e===undefined||e===""||e===null){return true}if(typeof e==="string"){e=e.replace(trimReg,"");if(e===""||e===null||e==="null"||e===undefined||e==="undefined"){return true}return false}else if(typeof e==="undefined"){return true}else if(typeof e==="object"){for(const t in e){return false}return true}else if(typeof e==="boolean"){return false}};const isFunc=e=>typeof e==="function";const processApis=function e(r,u,c={}){if(!u)return;const t=c.needPromiseApis||[];const n=c.needSyncApis||[];const{transformMeta:p}=c;t.forEach(e=>{const o=e;r[o]=(n={},...e)=>{let s=o;if(typeof n==="string"){if(e.length){return u[s](n,...e)}return u[s](n)}if(c.transformMeta){const{key:r,options:a}=p(s,n);s=r;n=a;if(!u.hasOwnProperty(s)){return temporarilyNotSupport(s)()}}const i=Object.assign({},n);const t=new Promise((t,r)=>{i.success=e=>{isFunc(n.success)&&n.success(e);t(e)};i.fail=e=>{isFunc(n.fail)&&n.fail(e);r(e)};i.complete=e=>{isFunc(n.complete)&&n.complete(e)};if(e.length){u[s](i,...e)}else{u[s](i)}});return t}});n.forEach(t=>{if(typeof u[t]==="function"){r[t]=(...e)=>{if(c.handleSyncApis){return c.handleSyncApis(t,u,e)}return u[t].apply(u,e)}}else{r[t]=u[t]}})};const version="0.0.7";var logger=createLogger("naruse-element");var NOOP=function e(){};var _config={hotPuller:function e(){logger.error("未初始化热更新拉取，无法更新组件默认为空");return Promise.resolve({code:"",ctx:{}})},baseCtx:function e(){return{}},onRunError:function e(t){console.error(t)}};var getNaruseConfig=function e(){return _config};var naruseInit=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=t.hotPuller,n=t.baseCtx,s=t.onRunError;if(r)_config.hotPuller=r;if(n)_config.baseCtx=n;if(s)_config.onRunError=s};const types={num:"num",string:"string",name:"name",bracketL:"[",bracketR:"]",braceL:"{",braceR:"}",parenL:"(",parenR:")",comma:",",semi:";",colon:":",dot:".",question:"?",eq:"=",logicalOR:"||",logicalAND:"&&",bitwiseOR:"|",bitwiseXOR:"^",bitwiseAND:"&",plusMin:"+/-",incDec:"++/--",equality:"==/!=/===/!==",relational:"</>/<=/>=",prefix:"!/~",modulo:"%",star:"*",slash:"/",assign:"_=",_break:"break",_continue:"continue",_else:"else",_for:"for",_function:"function",_if:"if",_return:"return",_var:"var",_const:"const",_let:"let",_in:"in",_instanceof:"instanceof",_new:"new",_import:"import",_null:"null",_true:"true",_false:"false",_void:"void",_typeof:"typeof",_delete:"delete",_try:"try",_catch:"catch",_throw:"throw",_finally:"_finally"};const emptyChar=["\n","\t"," ","\r"];const isEmptyChar=e=>emptyChar.includes(e);const tt=types;const keywords=[tt._break,tt._continue,tt._else,tt._for,tt._function,tt._if,tt._return,tt._const,tt._let,tt._null,tt._false,tt._true,tt._var,tt._in,tt._instanceof,tt._new];const priority={[tt.logicalOR]:1,[tt.logicalAND]:2,[tt.bitwiseOR]:3,[tt.bitwiseAND]:5,[tt.equality]:6,[tt.relational]:7,[tt.plusMin]:9,[tt.modulo]:10,[tt.star]:10,[tt.slash]:10,[tt._in]:7,[tt._instanceof]:7};class Token{constructor(e){this.input=e;this.pos=0;this.tokens=[]}scan(){while(1){const e=this.input[this.pos];if(isEmptyChar(e)){this.pos++;continue}if(!e)break;e.match(/[a-zA-Z_$]/)?this.readWord():this.getTokenFromCode(e.charCodeAt())}return this.tokens}getTokenFromCode(e){switch(e){case 46:return this.readToken_dot();case 40:++this.pos;return this.ftk(tt.parenL);case 41:++this.pos;return this.ftk(tt.parenR);case 59:++this.pos;return this.ftk(tt.semi);case 63:++this.pos;return this.ftk(tt.question);case 44:++this.pos;return this.ftk(tt.comma);case 91:++this.pos;return this.ftk(tt.bracketL);case 93:++this.pos;return this.ftk(tt.bracketR);case 123:++this.pos;return this.ftk(tt.braceL);case 125:++this.pos;return this.ftk(tt.braceR);case 58:++this.pos;return this.ftk(tt.colon);case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(e);case 34:case 39:return this.readString(e);case 37:case 42:case 47:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e)}++this.pos;console.warn(this.pos,`Unexpected character '${e}'`)}readWord(){let e="";let t;while(t=this.input[this.pos]){if(t.match(/[a-zA-Z0-9\_\$]/)){e+=t;this.pos++}else break}let r=tt.name;if(keywords.includes(e)){r=e}return this.ftk(r,e)}readToken_lt_gt(e){const t=this.gnc();let r=1;if(t===e){r=e===62&&this.gnc(2)===62?3:2;if(this.gnc(r)===61)return this.finishOp(tt.assign,r+1);return this.finishOp(tt.bitShift,r)}if(t===61)r=2;return this.finishOp(tt.relational,r)}readNumber(e){let t=0;while(e>47&&e<58||e===46){t++;e=this.gnc(t)}return this.finishOp(tt.num,parseFloat(t))}readString(e){const t=e;let r="";e=this.gnc();while(e!==t){r+=this.input[++this.pos];e=this.gnc()}this.pos=this.pos+2;return this.ftk(tt.string,r)}readToken_mult_modulo_exp(e){const t=this.gnc();const r=String.fromCharCode(e);const n=priority[r]&&r;if(t===61){this.pos++;return this.finishOp(tt.assign,2)}return this.finishOp(n,1)}finishOp(e,t){const r=this.input.substring(this.pos,this.pos+t);this.pos+=t;return this.ftk(e,r)}ftk(e,t){this.tokens.push({type:e,value:t,start:this.pos,end:this.pos+(t&&t.length||e.length)})}readToken_pipe_amp(e){const t=this.gnc();if(t===e)return this.finishOp(e===124?tt.logicalOR:tt.logicalAND,2);return this.finishOp(e===124?tt.bitwiseOR:tt.bitwiseAND,1)}readToken_dot(){const e=this.gnc();if(e>=48&&e<=57)return this.readNumber(true);this.pos++;return this.ftk(tt.dot)}gnc(e=1){return this.input[this.pos+e].charCodeAt()}readToken_plus_min(e){const t=this.gnc();if(t===e)return this.finishOp(tt.incDec,2);if(t===61)return this.finishOp(tt.assign,2);return this.finishOp(tt.plusMin,1)}readToken_eq_excl(e){const t=this.gnc();if(t===61)return this.finishOp(tt.equality,this.gnc(2)===61?3:2);return this.finishOp(e===61?tt.eq:tt.prefix,1)}}class Parser{constructor(e){this.tokens=new Token(e).scan();this.index=-1}parse(){const e={body:[]};this.nextToken();return this.parseTopLevel(e)}eat(e){if(this.type===e){this.next();return true}return false}nextToken(){this.token=this.tokens[++this.index];this.type=this.token&&this.token.type;this.value=this.token&&this.token.value;this.start=this.token&&this.token.start;this.end=this.token&&this.token.end}finishNode(e,t){e.type=t;e.start=this.start||0;e.end=this.end||0;return e}parseTopLevel(e){while(this.type){const t=this.parseStatement(true);e.body.push(t)}return this.finishNode(e,"Program")}parseStatement(e){const t={};switch(this.type){case tt._break:case tt._continue:return this.parseBreakContinueStatement(t,this.value);case tt._for:return this.parseForStatement(t);case tt._function:{this.next();return this.parseFunctionStatement(t)}case tt._if:return this.parseIfStatement(t);case tt._return:return this.parseReturnStatement(t);case tt._const:case tt._var:case tt._let:return this.parseVarStatement(t,this.value);case tt.braceL:return this.parseBlock(t);case tt.semi:return this.parseEmptyStatement(t);default:{const r=this.parseExpression();return this.parseExpressionStatement(t,r)}}}parseExpressionStatement(e,t){e.expression=t;this.eat(tt.semi);return this.finishNode(e,"ExpressionStatement")}parseEmptyStatement(e){this.next();return this.finishNode(e,"EmptyStatement")}parseVarStatement(e,t){this.next();this.parseVar(e,false,t);this.eat(tt.semi);return this.finishNode(e,"VariableDeclaration")}parseVar(e,t,r){e.declarations=[];e.kind=r;for(;;){const n={};this.parseVarId(n,r);if(this.eat(tt.eq)){n.init=this.parseMaybeAssign(t)}else{n.init=null}e.declarations.push(this.finishNode(n,"VariableDeclarator"));if(!this.eat(tt.comma))break}return e}parseIdent(){const e={};if(this.type===tt.name){e.name=this.value}else{this.raise("无法处理的token")}this.next();return this.finishNode(e,"Identifier")}parseMaybeAssign(e){const t=this.parseMaybeConditional(e);if(this.isAssign()){const r={};r.operator=this.value;r.left=t;this.next();r.right=this.parseMaybeAssign(e);return this.finishNode(r,"AssignmentExpression")}return t}parseMaybeConditional(e){const t=this.parseExprOps(e);if(this.eat(tt.question)){const r={};r.test=t;r.consequent=this.parseMaybeAssign();this.expect(tt.colon);r.alternate=this.parseMaybeAssign(e);return this.finishNode(r,"ConditionalExpression")}return t}parseExprOps(e){const t=this.parseMaybeUnary(e);return this.parseExprOp(t,-1,e)}parseExprOp(e,t,r){const n=priority[this.type];if(n&&!r){if(n>t){const s=this.type===tt.logicalOR||this.type===tt.logicalAND;const i=this.type===tt.coalesce;const a=this.value;this.next();const o=this.parseExprOp(this.parseMaybeUnary(r),n,r);const u=this.buildBinary(e,o,a,s||i);return this.parseExprOp(u,t,r)}}return e}buildBinary(e,t,r,n){const s={};s.left=e;s.operator=r;s.right=t;return this.finishNode(s,n?"LogicalExpression":"BinaryExpression")}parseMaybeUnary(e){let t;if([tt.incDec,tt.prefix,tt.plusMin].includes(this.type)){const r={};const n=this.type===tt.incDec;r.operator=this.value;r.prefix=true;this.next();r.argument=this.parseMaybeUnary(e);t=this.finishNode(r,n?"UpdateExpression":"UnaryExpression")}else{t=this.parseExprSubscripts(e);while(this.type===tt.incDec){const r={};r.operator=this.value;r.prefix=false;r.argument=t;this.next();t=this.finishNode(r,"UpdateExpression")}}return t}parseExprSubscripts(e){const t=this.parseExprAtom(e);const r=this.parseSubscripts(t,false,e);return r}parseSubscript(e,t){const r=this.eat(tt.bracketL);if(r||this.eat(tt.dot)){const n={};n.object=e;if(r){n.property=this.parseExpression();this.expect(tt.bracketR)}else{n.property=this.parseIdent()}n.computed=!!r;e=this.finishNode(n,"MemberExpression")}else if(!t&&this.eat(tt.parenL)){const s=this.parseExprList(tt.parenR);const n={};n.callee=e;n.arguments=s;e=this.finishNode(n,"CallExpression")}return e}parseExpression(e){const t=this.parseMaybeAssign(e);if(this.type===tt.comma){const r={};r.expressions=[t];while(this.eat(tt.comma))r.expressions.push(this.parseMaybeAssign(e));return this.finishNode(r,"SequenceExpression")}return t}parseSubscripts(e,t){while(true){const r=this.parseSubscript(e,t);if(r===e){return r}e=r}}parseLiteral(e){const t=this.finishNode({value:(this.type===tt.string?String:parseFloat)(e)},"Literal");this.next();return t}parseExprAtom(e){const t={};switch(this.type){case tt.name:return this.parseIdent(false);case tt.num:case tt.string:return this.parseLiteral(this.value);case tt._null:case tt._true:case tt._false:t.value=this.type===tt._null?null:this.type===tt._true;t.raw=this.type;this.next();return this.finishNode(t,"Literal");case tt.parenL:return this.parseParenAndDistinguishExpression(e);case tt.bracketL:this.next();t.elements=this.parseExprList(tt.bracketR);return this.finishNode(t,"ArrayExpression");case tt.braceL:return this.parseObj(false);case tt._function:this.next();return this.parseFunctionStatement(t);case tt._new:return this.parseNew();default:this.raise(`无法处理的token${this.type}`)}}parseNew(){const e={};this.next();e.callee=this.parseSubscripts(this.parseExprAtom(),true);if(this.eat(tt.parenL))e.arguments=this.parseExprList(tt.parenR);else e.arguments=[];return this.finishNode(e,"NewExpression")}parseObj(e){const t={};let r=true;t.properties=[];this.next();while(!this.eat(tt.braceR)){if(!r){this.expect(tt.comma)}else r=false;const n=this.parseProperty(e);t.properties.push(n)}return this.finishNode(t,e?"ObjectPattern":"ObjectExpression")}parseProperty(){const e={};e.key=this.type===tt.num||this.type===tt.string?this.parseExprAtom():this.parseIdent();if(this.eat(tt.colon)){e.value=this.parseMaybeAssign(false);e.kind="init"}else this.raise("属性名后无效属性");return this.finishNode(e,"Property")}parseParenAndDistinguishExpression(){return this.parseParenExpression()}parseVarId(e){e.id=this.parseIdent()}parseReturnStatement(e){this.next();if(this.eat(tt.semi)||this.type===tt.braceR)e.argument=null;else e.argument=this.parseExpression();return this.finishNode(e,"ReturnStatement")}parseIfStatement(e){this.next();e.test=this.parseParenExpression();e.consequent=this.parseStatement();e.alternate=this.eat(tt._else)?this.parseStatement():null;return this.finishNode(e,"IfStatement")}parseParenExpression(){this.expect(tt.parenL);const e=this.parseExpression();this.expect(tt.parenR);return e}parseFunctionStatement(e){e.id=this.type!==tt.name?null:this.parseIdent();this.parseFunctionParams(e);this.parseFunctionBody(e);return this.finishNode(e,"FunctionDeclaration")}parseFunctionParams(e){this.expect(tt.parenL);e.params=this.parseBindingList(tt.parenR,false)}parseFunctionBody(e){e.body=this.parseBlock(undefined)}parseBlock(e={}){e.body=[];const t=this.eat(tt.braceL);while(this.type&&this.type!==tt.braceR){const r=this.parseStatement();e.body.push(r);if(!t)break}this.next();return this.finishNode(e,"BlockStatement")}parseBindingList(e){const t=[];let r=true;while(!this.eat(e)){if(r)r=false;else this.expect(tt.comma);const n=this.parseMaybeDefault();t.push(n)}return t}parseExprList(e){const t=[];let r=true;while(!this.eat(e)){if(!r){this.expect(tt.comma)}else r=false;t.push(this.parseMaybeAssign(false))}return t}parseMaybeDefault(e){e=e||this.parseIdent();if(!this.eat(tt.eq))return e;const t={};t.left=e;t.right=this.parseMaybeAssign();return this.finishNode(t,"AssignmentPattern")}parseBreakContinueStatement(e,t){const r=t==="break";this.next();return this.finishNode(e,r?"BreakStatement":"ContinueStatement")}next(){this.nextToken()}parseForStatement(e){this.next();this.expect(tt.parenL);if(this.type===tt.semi){return this.parseFor(e,null)}if([tt._const,tt._var,tt._let].includes(this.type)){const t={kind:this.type};this.next();this.parseVar(t,true,t.kind);this.finishNode(t,"VariableDeclaration");return this.parseFor(e,t)}const t=this.parseExpression(true);return this.parseFor(e,t)}isAssign(){return[tt.assign,tt.eq].includes(this.type)}raise(e){throw new Error(e)}parseFor(e,t){e.init=t;this.expect(tt.semi);e.test=this.type===tt.semi?null:this.parseExpression();this.expect(tt.semi);e.update=this.type===tt.parenR?null:this.parseExpression();this.expect(tt.parenR);this.parseBlock(e);return this.finishNode(e,"ForStatement")}expect(e){this.eat(e)||this.raise(`unsupport type${e}`)}}const _defineProperty=function e(t,r,n){if(r in t){Object.defineProperty(t,r,{value:n,enumerable:true,configurable:true,writable:true})}else{t[r]=n}return t};const _typeof=e=>typeof e;const babelPolyfill={_defineProperty:_defineProperty,typeof:_typeof};let anonymousId=0;const BREAK_SINGAL={};const CONTINUE_SINGAL={};const RETURN_SINGAL={result:undefined};const illegalFun=[setTimeout,setInterval,clearInterval,clearTimeout];const evaluate_map={Program:(e,t)=>{for(const r of e.body)evaluate(r,t)},Identifier:(e,t)=>{if(e.name==="undefined"){return undefined}const r=t.$find(e.name);if(r){return r.$get()}throw`[Error] 变量'${e.name}' 未定义`},Literal:e=>{return e.value},BlockStatement:(e,t)=>{const r=t.invasived?t:new Scope("block",t);for(const n of e.body){const s=evaluate(n,r);if(s===BREAK_SINGAL||s===CONTINUE_SINGAL||s===RETURN_SINGAL){return s}}},EmptyStatement:()=>{},ExpressionStatement:(e,t)=>{evaluate(e.expression,t)},ReturnStatement:(e,t)=>{RETURN_SINGAL.result=e.argument?evaluate(e.argument,t):undefined;return RETURN_SINGAL},BreakStatement:()=>{return BREAK_SINGAL},ContinueStatement:()=>{return CONTINUE_SINGAL},IfStatement:(e,t)=>{if(evaluate(e.test,t))return evaluate(e.consequent,t);else if(e.alternate)return evaluate(e.alternate,t)},ForStatement:(e,t)=>{for(const r=new Scope("loop",t),n=e.init?evaluate(e.init,r):null;e.test?evaluate(e.test,r):true;e.update?evaluate(e.update,r):void 0){const s=evaluate({type:"BlockStatement",body:e.body},r);if(s===BREAK_SINGAL){break}else if(s===CONTINUE_SINGAL){continue}else if(s===RETURN_SINGAL){return s}}},FunctionDeclaration:(e,t)=>{const r=evaluate_map.FunctionExpression(e,t);const{name:n}=e.id||{name:`anonymous${anonymousId++}`};if(!t.$var(n,r)){throw`[Error] ${n} 重复定义`}return r},VariableDeclaration:(e,t)=>{const{kind:r}=e;for(const n of e.declarations){const{name:s}=n.id;const i=n.init?evaluate(n.init,t):undefined;if(!t.$declar(r,s,i)){throw`[Error] ${s} 重复定义`}}},ThisExpression:(e,t)=>{const r=t.$find("this");return r?r.$get():null},ArrayExpression:(e,t)=>{return e.elements.map(e=>evaluate(e,t))},ObjectExpression:(e,t)=>{const r={};for(const n of e.properties){const{kind:s}=n;let e;if(n.key.type==="Literal"){e=evaluate(n.key,t)}else if(n.key.type==="Identifier"){e=n.key.name}const i=evaluate(n.value,t);if(s==="init"){r[e]=i}else if(s==="set"){Object.defineProperty(r,e,{set:i})}else if(s==="get"){Object.defineProperty(r,e,{get:i})}}return r},FunctionExpression:(s,i)=>{function e(...t){const r=new Scope("function",i);r.invasived=true;for(let e=0;e<s.params.length;e++){const{name:n}=s.params[e];r.$const(n,t[e])}r.$const("this",this);r.$const("arguments",arguments);const e=evaluate(s.body,r);if(e===RETURN_SINGAL){return e.result}}Object.defineProperty(e,"length",{value:s.params.length});return e},UnaryExpression:(s,i)=>{return{"-":()=>-evaluate(s.argument,i),"+":()=>+evaluate(s.argument,i),"!":()=>!evaluate(s.argument,i),"~":()=>~evaluate(s.argument,i),void:()=>void evaluate(s.argument,i),typeof:()=>{if(s.argument.type==="Identifier"){const e=i.$find(s.argument.name);return e?typeof e.$get():"undefined"}else{return typeof evaluate(s.argument,i)}},delete:()=>{if(s.argument.type==="MemberExpression"){const{object:e,property:t,computed:r}=s.argument;if(r){return delete evaluate(e,i)[evaluate(t,i)]}else{return delete evaluate(e,i)[t.name]}}else if(s.argument.type==="Identifier"){const n=i.$find("this");if(n)return n.$get()[s.argument.name]}}}[s.operator]()},UpdateExpression:(e,t)=>{const{prefix:r}=e;let n;if(e.argument.type==="Identifier"){const{name:s}=e.argument;n=t.$find(s);if(!n)throw`${s} 未定义`}else if(e.argument.type==="MemberExpression"){const{argument:i}=e;const a=evaluate(i.object,t);const o=i.computed?evaluate(i.property,t):i.property.name;n={$set(e){a[o]=e;return true},$get(){return a[o]}}}return{"--":e=>(n.$set(e-1),r?--e:e--),"++":e=>(n.$set(e+1),r?++e:e++)}[e.operator](evaluate(e.argument,t))},BinaryExpression:(e,t)=>{return{"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">":(e,t)=>e>t,">=":(e,t)=>e>=t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"&":(e,t)=>e&t,in:(e,t)=>e in t,instanceof:(e,t)=>e instanceof t}[e.operator](evaluate(e.left,t),evaluate(e.right,t))},AssignmentExpression:(e,t)=>{let r;if(e.left.type==="Identifier"){const{name:n}=e.left;const s=t.$find(n);if(!s)throw`${n} 未定义`;r=s}else if(e.left.type==="MemberExpression"){const{left:i}=e;const a=evaluate(i.object,t);const o=i.computed?evaluate(i.property,t):i.property.name;r={$set(e){a[o]=e;return true},$get(){return a[o]}}}else{throw"如果出现在这里，那就说明有问题了"}return{"=":e=>(r.$set(e),e),"+=":e=>(r.$set(r.$get()+e),r.$get()),"-=":e=>(r.$set(r.$get()-e),r.$get()),"*=":e=>(r.$set(r.$get()*e),r.$get()),"/=":e=>(r.$set(r.$get()/e),r.$get()),"%=":e=>(r.$set(r.$get()%e),r.$get()),"|=":e=>(r.$set(r.$get()|e),r.$get()),"^=":e=>(r.$set(r.$get()^e),r.$get()),"&=":e=>(r.$set(r.$get()&e),r.$get())}[e.operator](evaluate(e.right,t))},LogicalExpression:(e,t)=>{return{"||":()=>evaluate(e.left,t)||evaluate(e.right,t),"&&":()=>evaluate(e.left,t)&&evaluate(e.right,t)}[e.operator]()},MemberExpression:(e,t)=>{const{object:r,property:n,computed:s}=e;if(s){return evaluate(r,t)[evaluate(n,t)]}return evaluate(r,t)[n.name]},ConditionalExpression:(e,t)=>{return evaluate(e.test,t)?evaluate(e.consequent,t):evaluate(e.alternate,t)},CallExpression:(e,t)=>{let r=null;let n=null;if(e.callee.type==="MemberExpression"){const{object:s,property:i,computed:a}=e.callee;r=evaluate(s,t);const o=!a?i.name:evaluate_map[i.type](i,t);n=r[o];if(illegalFun.includes(n))r=null}else{r=t.$find("this").$get();n=evaluate(e.callee,t);if(illegalFun.includes(n))r=null}return n.apply(r,e.arguments.map(e=>evaluate(e,t)))},NewExpression:(e,t)=>{const r=evaluate(e.callee,t);const n=e.arguments.map(e=>evaluate(e,t));return new r(...n)},SequenceExpression:(e,t)=>{let r;for(const n of e.expressions){r=evaluate(n,t)}return r},ThrowStatement:(e,t)=>{throw evaluate(e.argument,t)},TryStatement:(t,r)=>{try{return evaluate(t.block,r)}catch(e){if(t.handler){const n=t.handler.param;const s=new Scope("block",r);s.invasived=true;s.$const(n.name,e);return evaluate(t.handler,s)}else{throw e}}finally{if(t.finalizer)return evaluate(t.finalizer,r)}},CatchClause:(e,t)=>{return evaluate(e.body,t)}};class ScopeVar{constructor(e,t){this.value=t;this.kind=e}$set(e){if(this.value==="const"){return false}this.value=e;return true}$get(){return this.value}}class Scope{constructor(e,t){this.type=e;this.parent=t||null;this.content={};this.invasived=false;this.prefix=""}$find(e){const t=this.prefix+e;if(this.content.hasOwnProperty(t)){return this.content[t]}else if(this.parent){return this.parent.$find(e)}return null}$let(e,t){const r=this.prefix+e;const n=this.content[r];if(!n){this.content[r]=new ScopeVar("let",t);return true}return false}$const(e,t){const r=this.prefix+e;const n=this.content[r];if(!n){this.content[r]=new ScopeVar("const",t);return true}return false}$var(e,t){const r=this.prefix+e;let n=this;while(n.parent!==null&&n.type!=="function"){n=n.parent}const s=n.content[r];if(!s){this.content[r]=new ScopeVar("var",t);return true}return false}$declar(e,t,r){return{var:()=>this.$var(t,r),let:()=>this.$let(t,r),const:()=>this.$const(t,r)}[e]()}}let traceId=0;const traceStack=[];let runingCode="";const findErrorCode=e=>{if(!e)return runingCode;e=e<0?-1:e;let t=e;let r=e;let n=0;let s=0;const i=runingCode.length-1;const a=[0,i];while(!(t===-1&&r===i)){if(t!==-1){if([59,19].includes(runingCode[t].charCodeAt())){if(n===2){a[0]=t+1;t=-1}else{n++;t++}}else{t!==-1&&t--}}if(r!==i){if([59,19].includes(runingCode[r].charCodeAt())){if(s===2){a[1]=r;r=i}else{s++;r++}}else{r++}}}const o=runingCode.slice(a[0],a[1]);const u=a[1]-a[0];return`${o}\n${"^".repeat(u>40?40:u)}`};const evaluate=(t,e,r)=>{const n=traceId++;const s=e=>{if(traceStack[traceStack.length-1]===n&&e){console.error(`[naruse-parser] 错误代码\n${findErrorCode(t.end-3)}`);e&&console.error("[naruse-parser] 错误信息",e);throw new Error("[naruse-parser] 代码执行错误！")}};traceStack.push(n);const i=evaluate_map[t.type]||s();try{const a=i(t,e,r);traceStack.pop();return a}catch(e){s(e)}};const default_api={console:console,setTimeout:setTimeout,setInterval:setInterval,clearTimeout:clearTimeout,clearInterval:clearInterval,encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,decodeURI:decodeURI,decodeURIComponent:decodeURIComponent,Infinity:Infinity,NaN:NaN,isFinite:isFinite,isNaN:isNaN,parseFloat:parseFloat,parseInt:parseInt,Object:Object,Boolean:Boolean,Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,Number:Number,Math:Math,Date:Date,String:String,RegExp:RegExp,Array:Array,JSON:JSON,Promise:Promise};Object.assign(default_api,babelPolyfill);const run=(e,t={})=>{runingCode=e;traceStack.length=0;const r=new Scope("block");r.$const("this",undefined);for(const a of Object.getOwnPropertyNames(default_api)){r.$const(a,default_api[a])}for(const a of Object.getOwnPropertyNames(t)){r.$const(a,t[a])}const n={};r.$const("exports",n);const s=new Parser(e);const i=s.parse();evaluate(i,r);return n};var NaruseComponent$1=function(){function t(e){_classCallCheck(this,t);this.state={};this.props=e;this.$mounted=false;this.$updater=null}_createClass(t,[{key:"setState",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:NOOP;if(!this.$updater){logger.error("小程序组件未装载完毕，无法更新！");return}if(_typeof$1(t)!=="object"){logger.error("setState 不支持的数据格式！",t);return}if(this.state===t)return;this.state=_objectSpread2(_objectSpread2({},this.state),t);this.$updater.update(r)}},{key:"forceUpdate",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:NOOP;if(!this.$updater){logger.error("小程序组件未装载完毕，无法更新！");return}this.$updater.update(t)}},{key:"componentDidMount",value:function e(){}},{key:"componentDidUpdate",value:function e(){}},{key:"componentWillUnmount",value:function e(){}},{key:"render",value:function e(){}}]);return t}();var isNaruseComponent=function e(t){return t instanceof NaruseComponent$1};var vnodeSpecialMap={text:function e(t,r){return{content:r?r[0]:""}}};var createElement=function e(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++){s[i-2]=arguments[i]}if(isNaruseComponent(t.prototype))return createClassElement(t,r,s);if(typeof t==="function")return createFuncElement(t,r,s);return createBaseElement(t,r,s)};var createClassElement=function e(t,r,n){r=_objectSpread2(_objectSpread2({},r),{},{children:n});var s={actuator:t,props:r};return{naruseType:"naruse-element",component:s}};var createBaseElement=function e(t,r,n){var s={};if(vnodeSpecialMap[t])s=vnodeSpecialMap[t](r,n);n=n.flat&&n.flat(1)||n;n=n.map(function(e){if(typeof e==="string"||typeof e==="number")return{naruseType:"text",content:e};return e});var i=_objectSpread2(_objectSpread2({naruseType:t},r),{},{childNodes:n},s);return i};var createFuncElement=function e(t,r,n){return t(_objectSpread2(_objectSpread2({},r),{},{children:n}))};var apiDiff={getClipboardData:{alias:"getClipboard"},setClipboardData:{alias:"setClipboard",options:{change:[{old:"data",new:"text"}]}}};var transformMeta=function e(s,i){var a=s;Object.keys(apiDiff).forEach(function(e){var t=apiDiff[e];if(s===e){if(t.alias){a=t.alias}if(t.options){var r=t.options.change;var n=t.options.set;if(r){r.forEach(function(e){i[e["new"]]=i[e.old]})}if(n){n.forEach(function(e){i[e.key]=typeof e.value==="function"?e.value(i):e.value})}}}});return{key:a,options:i}};var handleSyncApis=function e(t,r,n){if(t==="getStorageSync"){var s=n[0];if(s!=null){var i=r[t]({key:s});var a=null;if(i.hasOwnProperty("data")){a=i.data}else if(i.hasOwnProperty("APDataStorage")){a=i.APDataStorage}return a===null?"":a}return console.error("getStorageSync 传入参数错误")}if(t==="setStorageSync"){var o=n[0];var u=n[1];if(o!=null){return r[t]({key:o,data:u})}return console.error("setStorageSync 传入参数错误")}if(t==="removeStorageSync"){var c=n[0];if(c!=null){return r[t]({key:c})}return console.error("removeStorageSync 传入参数错误")}if(t==="createSelectorQuery"){var p=r[t]();p["in"]=function(){return p};return p}return r[t].apply(r,n)};var needPromiseApis=["getStorage","setStorage","removeStorage","clearStorage","getStorageInfo","getSystemInfo","navigateTo","navigateBack","setClipboard","getClipboard"];var syncApis=["getStorageSync","setStorageSync","removeStorageSync","clearStorageSync","getStorageInfoSync"];var qnPromiseApis=["navigateToWebPage"];var initNaruseAlipayApi=function e(){var t={};processApis(t,my,{transformMeta:transformMeta,needPromiseApis:needPromiseApis,handleSyncApis:handleSyncApis,needSyncApis:syncApis});processApis(t,my.qn,{needPromiseApis:qnPromiseApis});return t};var pageCenter={};var getPageInstance=function e(t){if(!t){logger.error("无效组件");return}var r=t.$page&&t.$page.$id;if(!r){logger.error("无效页面id");return}if(!pageCenter[r]){pageCenter[r]=new Page(t.$page);return pageCenter[r]}return pageCenter[r]};var Page=function(){function t(e){_classCallCheck(this,t);this.miniPage=e;this.eventCenter=new EventBus;this.oldEvents={};this.interceptEvent("onShow");this.interceptEvent("onHide");this.interceptEvent("onUnload");this.interceptEvent("onPullDownRefresh");this.interceptEvent("onPageScroll")}_createClass(t,[{key:"interceptEvent",value:function e(t){var n=this;var r=this;r.oldEvents[t]=r.miniPage[t];var s=r.miniPage[t];r.eventCenter.on(t,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return typeof s==="function"&&s.apply(n.miniPage,t)});Object.defineProperty(this.miniPage,t,{get:function e(){return function(){return r.eventCenter.emit(t)}},set:function e(){logger.error("正在修改页面事件，请勿修改，请使用Naruse.Page.on()")},enumerable:true,configurable:true})}},{key:"on",value:function e(t,r){this.eventCenter.on(t,r)}},{key:"off",value:function e(t,r){this.eventCenter.off(t,r)}},{key:"route",get:function e(){return this.miniPage.route}},{key:"clear",value:function e(){var t=this;this.eventCenter.clear();Object.keys(this.oldEvents).forEach(function(e){t.miniPage[e]=t.oldEvents[e]});this.miniPage=null;this.oldEvents={}}}]);return t}();var withPage=function e(n){return function(e){_inherits(r,e);var t=_createSuper(r);function r(){_classCallCheck(this,r);return t.apply(this,arguments)}_createClass(r,[{key:"render",value:function e(){var t=getPageInstance(this.$updater&&this.$updater.component);var r={route:t.route,events:{on:t.on.bind(t),off:t.off.bind(t)}};return createElement(n,_objectSpread2(_objectSpread2({},this.props),{},{currentPage:r}))}}]);return r}(NaruseComponent$1)};var apis=initNaruseAlipayApi();var Naruse=_objectSpread2(_objectSpread2(_objectSpread2({Component:NaruseComponent$1,globalEvent:globalEvent,EventBus:EventBus,env:{clientName:"alipay",clientVersion:version,language:"zh-Hans",platform:"alipay"},version:version},my),apis),{},{withPage:withPage});var naruseExtend=function e(t){if(_typeof$1(t)==="object"){Object.assign(Naruse,t)}};my.Naruse=Naruse;var getNaruseComponentFromProps=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var n,s,i,a,o;return regeneratorRuntime.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:if(!r||_typeof$1(r)!=="object"){logger.error("无效参数，无法生成对应naruse组件")}n=getNaruseConfig(),s=n.hotPuller;t.next=5;return s(r);case 5:i=t.sent;a=i.code;o=i.ctx;return t.abrupt("return",getNaruseComponentFromCode(a,o));case 9:case"end":return t.stop()}}},e)}));return function e(t){return r.apply(this,arguments)}}();var getNaruseComponentFromCode=function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function e(r,n){var s,i,a,o,u,c,p;return regeneratorRuntime.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:s=getNaruseConfig(),i=s.baseCtx,a=s.onRunError;o=typeof i==="function"?i():i;u={};t.prev=3;u=run(r,_objectSpread2(_objectSpread2({h:createElement,Naruse:Naruse,my:(typeof my==="undefined"?"undefined":_typeof$1(my))==="object"?my:{}},o),n));t.next=12;break;case 7:t.prev=7;t.t0=t["catch"](3);logger.error("运行时出错，自动继续",t.t0);a(t.t0);return t.abrupt("return");case 12:c=null;if(u["default"]){c=u["default"]}else{p=function e(){var s=this;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}NaruseComponent.apply(this,r);u.constructor&&u.constructor.call(this);Object.entries(u).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],n=t[1];if(r==="constructor")return;s[r]=typeof n==="function"?n.bind(s):n})};p.prototype=Object.create(NaruseComponent.prototype);Object.assign(p.prototype,{constructor:p});c=p}return t.abrupt("return",c);case 15:case"end":return t.stop()}}},e,null,[[3,7]])}));return function e(t,r){return n.apply(this,arguments)}}();var allowPropagetionEventNames=["onLongClick","onClick"];var randomId=function e(t){var r=Date.now().toString(36);r+=Math.random().toString(36).slice(2,t);return r};var getPathById=function e(t,r){var n=[];if(r.id===t)return n;if(!r.childNodes||!r.childNodes.length)return;for(var s=0;s<r.childNodes.length;s++){if(r.childNodes[s].id===t){n.push(s);return n}}for(var i=0;i<r.childNodes.length;i++){var a=e(t,r.childNodes[i]);if(a){n.push(i);for(var o=0;o<a.length;o++){n.push(a[o])}return n}}};var getVnodeById=function e(t,r){var n=getPathById(t,r);if(!n)return undefined;if(!n.length)return r;var s=r;n.forEach(function(e){s=s.childNodes[e]});return s};var initVnodeTree=function t(e,r){var n=e;if(!e||_typeof$1(e)!=="object")return{};if(!n.id)n.id=randomId(16);n.parentId=r;if(Array.isArray(n.childNodes)){n.childNodes.forEach(function(e){return t(e,n.id)})}return n};var eventNameMap={tap:"onClick",longPress:"onLongClick",input:"onChange",blur:"onBlur",focus:"onFocus",load:"onLoad",change:"onChange"};var eventCenter=function e(t,r){var n=false;if(!(t&&t.target&&t.target.id))return;var s=getVnodeById(t.target.id,r);if(!s)return;var i=t.type;var a=eventNameMap[i];if(!a){logger.warn("".concat(i,"事件不支持"))}if(allowPropagetionEventNames.includes(a)){n=true;t.stopPropagation=function(){n=false}}var o=s[a];if(!(o&&typeof o==="function"));else{o.call(s,t)}if(n){e(_objectSpread2(_objectSpread2({},t),{},{target:{id:s.parentId},narusePropagetion:true}),r)}};var allEvents=function e(t){eventCenter(t,this.data.node)};var miniappEventBehavior={props:{component:{}},data:{node:{}},methods:{onTap:allEvents,onLongPress:allEvents,onInputInput:allEvents,onInputBlur:allEvents,onInputFocus:allEvents,onImageLoad:allEvents,onCheckboxChange:allEvents}};var propsEquals=function e(t,r){if(Object.is(t,r)&&_typeof$1(t)!=="object"){return true}var n=Object.getOwnPropertyNames(t);var s=Object.getOwnPropertyNames(r);if(n.length!==s.length){return false}for(var i=0;i<n.length;i++){var a=n[i];if(t[a]!==r[a]){return false}}return true};var Middware=function(){function n(e,t,r){_classCallCheck(this,n);this.props=r;this.component=e;if(t instanceof NaruseComponent$1){this.naruseComponent=t}else{this.naruseComponent=new t(r);this.naruseComponent.props=r}this.naruseComponent.$updater=this;this.fristRender=true;this.updating=false}_createClass(n,[{key:"update",value:function e(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:NOOP;var s=this;!this.updating&&Promise.resolve().then(function(){r.updating=false;if(!r.naruseComponent.render){logger.error("组件必须需要一个render函数");return}var e=r.naruseComponent.render();var t=initVnodeTree(e);r.component.setData({node:t},function(){r.onUpdated.call(s);n()})});this.updating=true}},{key:"onUpdated",value:function e(){if(!this.naruseComponent)return;var t=this.fristRender?"componentDidMount":"componentDidUpdate";this.naruseComponent[t]&&this.naruseComponent[t]();if(this.fristRender)this.naruseComponent.$mounted=true;this.fristRender=false}},{key:"canUpdate",value:function e(t){if(!propsEquals(t,this.props)){this.prevProps=t;this.naruseComponent.props=this.props;this.update()}}},{key:"onUnMount",value:function e(){this.naruseComponent&&this.naruseComponent.componentWillUnmount();this.component=null;this.naruseComponent=null}}]);return n}();var bindedPages={};var renderComponentOnPage=function e(t,r){globalEvent.emit("naruse.renderComponentOnPage",t,r)};var bindRenderEventOnComponent=function e(r){if(!r)return;var n=r.$page.route;if(bindedPages[n]){logger.error("".concat(n,"-已经绑定了事件中心"));return}bindedPages[n]=r;r._naruseEventCenter=globalEvent;globalEvent.on("naruse.renderComponentOnPage",function(e,t){if(e!==n)return;r.$middware&&r.$middware.onUnMount();r.$middware=new Middware(r,t,{});r.$middware.update()})};var renderComponentOnPageWithCode=function(){var s=_asyncToGenerator(regeneratorRuntime.mark(function e(r,n,s){var i;return regeneratorRuntime.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:t.next=4;return getNaruseComponentFromCode(n,s);case 4:i=t.sent;renderComponentOnPage(r,i);case 6:case"end":return t.stop()}}},e)}));return function e(t,r,n){return s.apply(this,arguments)}}();var initMainComponent=function e(){var t=this;getNaruseComponentFromProps(this.props).then(function(e){t.$middware=new Middware(t,e,{});t.$middware.update()})["catch"](function(e){console.error("初始化主组件失败",e)})};var createVmContext$1=function e(){try{initMainComponent.call(this)}catch(e){logger.error("初始化失败",e)}};var createMainBehavior=function e(){var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=_objectSpread2(_objectSpread2({},miniappEventBehavior),{},{didMount:function e(){var t=this.props||{},r=t.unique,n=r===void 0?false:r;if(n)bindRenderEventOnComponent(this);this.option=s;createVmContext$1.call(this)},didUpdate:function e(t){if(!propsEquals(t,this.props)){this.$middware&&this.$middware.onUnMount();createVmContext$1.call(this)}},didUnmount:function e(){this.$middware&&this.$middware.onUnMount()}});return t};var initSubComponent=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=t.actuator,n=t.props;if(r){this.$middware=new Middware(this,r,n||{});this.$middware.update()}};var createVmContext=function e(){if(!isEmpty(this.props.component)){initSubComponent.call(this,this.props.component);return}logger.error("无效空naruse组件")};var createSubBehavior=function e(){var t=_objectSpread2(_objectSpread2({},miniappEventBehavior),{},{didMount:function e(){try{createVmContext.call(this)}catch(e){logger.error("子组件初始化失败",e)}},didUpdate:function e(t){if(!isEmpty(this.props.component)){var r=t.component,n=r.props,s=r.actuator;if(s===this.props.component.actuator&&n.key===this.props.component.props.key){this.$middware.props=this.props.component.props;this.$middware.canUpdate(n)}else{this.$middware.onUnMount();initSubComponent.call(this,this.props.component)}}},didUnmount:function e(){this.$middware.onUnMount()}});return t};naruseExtend({renderComponentOnPage:renderComponentOnPage});export{Naruse,createMainBehavior,createSubBehavior,naruseExtend,naruseInit,renderComponentOnPageWithCode};
